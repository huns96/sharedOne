<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "https://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.example.sharedOne.mapper.PriceMapper">

    <select id="listBuyer" resultType="com.example.sharedOne.domain.BuyerDto">
        SELECT
            buyer_code
            buyer_name
        FROM buyer
        WHERE
        <trim prefixOverrides="OR">
            <if test="type == 'buyer_code'">
                OR buyer_code LIKE #{keyword}
            </if>
            <if test="type == 'name'">
                OR name LIKE #{keyword}
            </if>
        </trim>
    </select>

    <update id="update">
        UPDATE price
        SET
            buyer_code = #{buyer_code},
            product_code = #{product_code},
            price = #{price},
            start_date = #{start_date},
            end_date = #{end_date},
            currency = #{currency},
        WHERE
            num = #{num}
    </update>

    <select id="selectPrice" resultType="com.example.sharedOne.domain.PriceDto">
        SELECT * FROM price
    </select>


    <select id="countAll" resultType="int">
        SELECT COUNT(*)
        FROM price
    </select>

    <select id="listPrice" resultType="com.example.sharedOne.domain.PriceDto">
        SELECT
        price.num,
        price.buyer_code,
        price.product_code,
        price.price,
        price.currency,
        price.start_date,
        price.end_date,
        price.delyn,
        price.adduser,
        price.adddate,
        price.upduser,
        price.upddate,
        buyer.name buyer_name,
        product.name product_name
        FROM price LEFT JOIN buyer ON price.buyer_code = buyer.buyer_code
        LEFT JOIN product ON price.product_code = product.product_code
        LIMIT #{offset}, #{records};
    </select>

    <insert id="insert">
        INSERT INTO price (buyer_code, product_code, price, start_date, end_date, currency, adduser)
        VALUES (#{buyer_code}, #{product_code}, #{price}, #{start_date}, #{end_date}, #{currency}, #{adduser})
    </insert>



</mapper>
